C51 COMPILER V6.02  BLINKING_LIGHTS                                                        12/04/2019 04:53:56 PAGE 1   


C51 COMPILER V6.02, COMPILATION OF MODULE BLINKING_LIGHTS
OBJECT MODULE PLACED IN .\Blinking_Lights.OBJ
COMPILER INVOKED BY: C:\Keil\C51\BIN\C51.EXE .\Blinking_Lights.c DEBUG OBJECTEXTEND

stmt level    source

   1          #include "Blinking_Lights.h"
   2          #include "Buttons.h"
   3          #include "Port.h"
   4          #include <stdio.h>
   5          
   6          volatile states_t SYSTEM_STATE = IDLE_STATE;
   7          volatile uint32_t TIMER_INTERVAL_DELAY = 660;
   8          volatile uint32_t TIMER = 0;
   9          volatile bit strobe_forward = 0;
  10          volatile bit strobe_backward = 0;
  11          
  12          void set_lights(uint8_t light_config) {
  13   1      	light_config = light_config << 4;
  14   1      	P2 = light_config|0x0F;
  15   1      }
  16          
  17          SW_values_t * SW1_p, *SW2_p, *SW3_p, *SW4_p;
  18          
  19          void blinking_lights_isr(void) interrupt TIMER_2_OVERFLOW {
  20   1      	TF2=0;
  21   1      	SW1_p = Return_SW1_address();
  22   1      	SW2_p = Return_SW2_address();
  23   1      	SW3_p = Return_SW3_address();
  24   1      	SW4_p = Return_SW4_address();
  25   1          TIMER++;
  26   1      
  27   1      	Read_Switch(SW1_p);
  28   1      	Read_Switch(SW2_p);
  29   1      	Read_Switch(SW3_p);
  30   1      	Read_Switch(SW4_p);
  31   1      	
  32   1      	if(SW2_p->SW_state==pressed||SW3_p->SW_state==pressed)
  33   1      	{
  34   2      		SYSTEM_STATE=TIMER_INCREMENT_MODE;
  35   2      	}
  36   1      	else if(SW1_p->SW_state==pressed)
  37   1      	{
  38   2      		strobe_forward = ~strobe_forward;
  39   2      		SYSTEM_STATE= IDLE_STATE;
  40   2      	}	
  41   1      	else if(SW4_p->SW_state==pressed)
  42   1      	{
  43   2      		strobe_backward = ~strobe_backward;
  44   2      		SYSTEM_STATE= IDLE_STATE;
  45   2      	}
  46   1      	else if((SYSTEM_STATE == IDLE_STATE&&TIMER>=TIMER_INTERVAL_DELAY))
  47   1      	{
  48   2      		set_lights(15);
  49   2      		if(strobe_forward==1)
  50   2      		{
  51   3      			SYSTEM_STATE = STATE_1;
  52   3      			TIMER=0;
  53   3      		}
  54   2      		else if(strobe_backward==1)
  55   2      		{
C51 COMPILER V6.02  BLINKING_LIGHTS                                                        12/04/2019 04:53:56 PAGE 2   

  56   3      			SYSTEM_STATE = STATE_7;
  57   3      			TIMER=0;
  58   3      		}
  59   2      	}
  60   1      	else if(SYSTEM_STATE==STATE_1&&TIMER>=TIMER_INTERVAL_DELAY)
  61   1      	{
  62   2      		set_lights(7);
  63   2      		if(strobe_forward==1)
  64   2      		{
  65   3      			SYSTEM_STATE = STATE_2;
  66   3      			TIMER=0;
  67   3      		}
  68   2      		else if(strobe_backward==1)
  69   2      		{
  70   3      			SYSTEM_STATE = IDLE_STATE;
  71   3      			TIMER=0;
  72   3      		}
  73   2      	}
  74   1      	else if(SYSTEM_STATE==STATE_2&&TIMER>=TIMER_INTERVAL_DELAY)
  75   1      	{		
  76   2      		set_lights(3);
  77   2      		if(strobe_forward==1)
  78   2      		{
  79   3      			SYSTEM_STATE = STATE_3;
  80   3      			TIMER=0;
  81   3      		}
  82   2      		else if(strobe_backward==1)
  83   2      		{
  84   3      			SYSTEM_STATE = STATE_1;
  85   3      			TIMER=0;
  86   3      		}
  87   2      	}
  88   1      	else if(SYSTEM_STATE==STATE_3&&TIMER>=TIMER_INTERVAL_DELAY)
  89   1      	{
  90   2      		set_lights(1);
  91   2      		if(strobe_forward==1)
  92   2      		{
  93   3      			SYSTEM_STATE = STATE_4;
  94   3      			TIMER=0;
  95   3      		}
  96   2      		else if(strobe_backward==1)
  97   2      		{
  98   3      			SYSTEM_STATE = STATE_2;
  99   3      			TIMER=0;
 100   3      		}
 101   2      	}
 102   1      	else if(SYSTEM_STATE==STATE_4&&TIMER>=TIMER_INTERVAL_DELAY)
 103   1      	{
 104   2      		set_lights(0);
 105   2      		if(strobe_forward==1)
 106   2      		{
 107   3      			SYSTEM_STATE = STATE_5;
 108   3      			TIMER=0;
 109   3      		}
 110   2      		else if(strobe_backward==1)
 111   2      		{
 112   3      			SYSTEM_STATE = STATE_3;
 113   3      			TIMER=0;
 114   3      		}
 115   2      	}
 116   1      	else if(SYSTEM_STATE==STATE_5&&TIMER>=TIMER_INTERVAL_DELAY)
 117   1      	{
C51 COMPILER V6.02  BLINKING_LIGHTS                                                        12/04/2019 04:53:56 PAGE 3   

 118   2      		set_lights(8);
 119   2      		if(strobe_forward==1)
 120   2      		{
 121   3      			SYSTEM_STATE = STATE_6;
 122   3      			TIMER=0;
 123   3      		}
 124   2      		else if(strobe_backward==1)
 125   2      		{
 126   3      			SYSTEM_STATE = STATE_4;
 127   3      			TIMER=0;
 128   3      		}
 129   2      	}
 130   1      	else if(SYSTEM_STATE==STATE_6&&TIMER>=TIMER_INTERVAL_DELAY)
 131   1      	{
 132   2      		set_lights(0xC);
 133   2      		if(strobe_forward==1)
 134   2      		{
 135   3      			SYSTEM_STATE = STATE_7;
 136   3      			TIMER=0;
 137   3      		}
 138   2      		else if(strobe_backward==1)
 139   2      		{
 140   3      			SYSTEM_STATE = STATE_5;
 141   3      			TIMER=0;
 142   3      		}
 143   2      	}
 144   1      	else if(SYSTEM_STATE==STATE_7&&TIMER>=TIMER_INTERVAL_DELAY)
 145   1      	{
 146   2      		set_lights(0xE);
 147   2      		if(strobe_forward==1)
 148   2      		{
 149   3      			SYSTEM_STATE = IDLE_STATE;
 150   3      			TIMER=0;
 151   3      		}
 152   2      		else if(strobe_backward==1)
 153   2      		{
 154   3      			SYSTEM_STATE = STATE_6;
 155   3      			TIMER=0;
 156   3      		}
 157   2      	}
 158   1      	else if(SYSTEM_STATE==TIMER_INCREMENT_MODE)
 159   1      	{
 160   2      		set_lights(0x00);
 161   2      	    if(SW2_p->SW_state==pressed)
 162   2      		{
 163   3      			TIMER_INTERVAL_DELAY+=60;
 164   3      			if(TIMER_INTERVAL_DELAY>=900)
 165   3      			{
 166   4      				TIMER_INTERVAL_DELAY=900;
 167   4      			}
 168   3      			set_lights(~((uint8_t) TIMER_INTERVAL_DELAY/60));
 169   3      		}
 170   2      		else if(SW3_p->SW_state==pressed)
 171   2      		{
 172   3      			TIMER_INTERVAL_DELAY-=60;
 173   3      			if(TIMER_INTERVAL_DELAY<60)
 174   3      			{
 175   4      				TIMER_INTERVAL_DELAY=60;
 176   4      			}
 177   3      			set_lights(~((uint8_t) TIMER_INTERVAL_DELAY/60));
 178   3      		}
 179   2      		else if(SW1_p==pressed||SW4_p==pressed)
C51 COMPILER V6.02  BLINKING_LIGHTS                                                        12/04/2019 04:53:56 PAGE 4   

 180   2      		{
 181   3      			SYSTEM_STATE = IDLE_STATE;
 182   3      		}
 183   2      	}
 184   1      }
 185          
 186          


MODULE INFORMATION:   STATIC OVERLAYABLE
   CODE SIZE        =   1062    ----
   CONSTANT SIZE    =   ----    ----
   XDATA SIZE       =   ----    ----
   PDATA SIZE       =   ----    ----
   DATA SIZE        =     21    ----
   IDATA SIZE       =   ----    ----
   BIT SIZE         =      2    ----
END OF MODULE INFORMATION.


C51 COMPILATION COMPLETE.  0 WARNING(S),  0 ERROR(S)
