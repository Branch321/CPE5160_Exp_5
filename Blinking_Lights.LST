C51 COMPILER V6.02  BLINKING_LIGHTS                                                        12/04/2019 07:49:34 PAGE 1   


C51 COMPILER V6.02, COMPILATION OF MODULE BLINKING_LIGHTS
OBJECT MODULE PLACED IN .\Blinking_Lights.OBJ
COMPILER INVOKED BY: C:\Keil\C51\BIN\C51.EXE .\Blinking_Lights.c DEBUG OBJECTEXTEND

stmt level    source

   1          #include "Blinking_Lights.h"
   2          #include "Buttons.h"
   3          #include "Port.h"
   4          #include <stdio.h>
   5          
   6          volatile states_t SYSTEM_STATE = IDLE_STATE;
   7          volatile uint32_t TIMER_INTERVAL_DELAY = 660;
   8          volatile uint32_t TIMER = 0;
   9          volatile bit strobe_forward = 0;
  10          volatile bit strobe_backward = 0;
  11          
  12          void set_lights(uint8_t light_config) {
  13   1      	light_config = light_config << 4;
  14   1      	P2 = light_config|0x0F;
  15   1      }
  16          
  17          SW_values_t * SW1_p, *SW2_p, *SW3_p, *SW4_p;
  18          
  19          void blinking_lights_isr(void) interrupt TIMER_2_OVERFLOW {
  20   1      	TF2=0;
  21   1      	SW1_p = Return_SW1_address();
  22   1      	SW2_p = Return_SW2_address();
  23   1      	SW3_p = Return_SW3_address();
  24   1      	SW4_p = Return_SW4_address();
  25   1          TIMER++;
  26   1      
  27   1      	Read_Switch(SW1_p);
  28   1      	Read_Switch(SW2_p);
  29   1      	Read_Switch(SW3_p);
  30   1      	Read_Switch(SW4_p);
  31   1      	
  32   1      	if(SYSTEM_STATE == IDLE_STATE)
  33   1      	{
  34   2      		set_lights(15);
  35   2      		if(SW1_p->SW_state==pressed)
  36   2      		{
  37   3      			SYSTEM_STATE = STATE_1_L_to_R;
  38   3      		}
  39   2      		else if(SW4_p->SW_state==pressed)
  40   2      		{
  41   3      			SYSTEM_STATE = STATE_1_R_to_L;	
  42   3      		}
  43   2      		else if(SW2_p->SW_state==pressed || SW3_p->SW_state == pressed)
  44   2      		{
  45   3      			SYSTEM_STATE = TIMER_INCREMENT_MODE;
  46   3      		}
  47   2      	}
  48   1      	else if(SYSTEM_STATE == STATE_1_L_to_R)
  49   1      	{
  50   2      		set_lights(7);
  51   2      		if(TIMER>=TIMER_INTERVAL_DELAY)
  52   2      		{
  53   3      			SYSTEM_STATE = STATE_2_L_to_R;
  54   3      			TIMER=0;
  55   3      		}
C51 COMPILER V6.02  BLINKING_LIGHTS                                                        12/04/2019 07:49:34 PAGE 2   

  56   2      		else if(SW1_p->SW_state == pressed)
  57   2      		{
  58   3      			SYSTEM_STATE = IDLE_STATE;
  59   3      		}
  60   2      	}
  61   1      	else if(SYSTEM_STATE == STATE_2_L_to_R)
  62   1      	{
  63   2      		set_lights(3);
  64   2      		if(TIMER>=TIMER_INTERVAL_DELAY)
  65   2      		{
  66   3      			SYSTEM_STATE = STATE_3_L_to_R;
  67   3      			TIMER=0;
  68   3      		}
  69   2      		else if(SW1_p->SW_state == pressed)
  70   2      		{
  71   3      			SYSTEM_STATE = IDLE_STATE;
  72   3      		}
  73   2      	}
  74   1      	else if(SYSTEM_STATE == STATE_3_L_to_R)
  75   1      	{
  76   2      		set_lights(1);
  77   2      		if(TIMER>=TIMER_INTERVAL_DELAY)
  78   2      		{
  79   3      			SYSTEM_STATE = STATE_4_L_to_R;
  80   3      			TIMER=0;
  81   3      		}
  82   2      		else if(SW1_p->SW_state == pressed)
  83   2      		{
  84   3      			SYSTEM_STATE = IDLE_STATE;
  85   3      		}
  86   2      	}
  87   1      	else if(SYSTEM_STATE == STATE_4_L_to_R)
  88   1      	{
  89   2      		set_lights(0);
  90   2      		if(TIMER>=TIMER_INTERVAL_DELAY)
  91   2      		{
  92   3      			SYSTEM_STATE = STATE_1_L_to_R;
  93   3      			TIMER=0;
  94   3      		}
  95   2      		else if(SW1_p->SW_state == pressed)
  96   2      		{
  97   3      			SYSTEM_STATE = IDLE_STATE;
  98   3      		}
  99   2      	}
 100   1      	else if(SYSTEM_STATE == STATE_1_R_to_L)
 101   1      	{
 102   2      		set_lights(14);
 103   2      		if(TIMER>=TIMER_INTERVAL_DELAY)
 104   2      		{
 105   3      			SYSTEM_STATE = STATE_2_R_to_L;
 106   3      			TIMER=0;
 107   3      		}
 108   2      		else if(SW4_p->SW_state == pressed)
 109   2      		{
 110   3      			SYSTEM_STATE = IDLE_STATE;
 111   3      		}
 112   2      	}
 113   1      	else if(SYSTEM_STATE == STATE_2_R_to_L)
 114   1      	{
 115   2      		set_lights(12);
 116   2      		if(TIMER>=TIMER_INTERVAL_DELAY)
 117   2      		{
C51 COMPILER V6.02  BLINKING_LIGHTS                                                        12/04/2019 07:49:34 PAGE 3   

 118   3      			SYSTEM_STATE = STATE_3_R_to_L;
 119   3      			TIMER=0;
 120   3      		}
 121   2      		else if(SW4_p->SW_state == pressed)
 122   2      		{
 123   3      			SYSTEM_STATE = IDLE_STATE; 
 124   3      		}
 125   2      	}
 126   1      	else if(SYSTEM_STATE == STATE_3_R_to_L)
 127   1      	{
 128   2      		set_lights(8);
 129   2      		if(TIMER>=TIMER_INTERVAL_DELAY)
 130   2      		{
 131   3      			SYSTEM_STATE = STATE_4_R_to_L;
 132   3      			TIMER=0;
 133   3      		}
 134   2      		else if(SW4_p->SW_state == pressed)
 135   2      		{
 136   3      			SYSTEM_STATE = IDLE_STATE; 
 137   3      		}
 138   2      	}
 139   1      	else if(SYSTEM_STATE == STATE_4_R_to_L)
 140   1      	{
 141   2      		set_lights(0);
 142   2      		if(TIMER>=TIMER_INTERVAL_DELAY)
 143   2      		{
 144   3      			SYSTEM_STATE = STATE_1_R_to_L;
 145   3      			TIMER=0;
 146   3      		}
 147   2      		else if(SW4_p->SW_state == pressed)
 148   2      		{
 149   3      			SYSTEM_STATE = IDLE_STATE; 
 150   3      		}
 151   2      	}
 152   1      	else if(SYSTEM_STATE==TIMER_INCREMENT_MODE)
 153   1      	{
 154   2      	    set_lights(~((uint8_t) TIMER_INTERVAL_DELAY/60));
 155   2      	    if(SW2_p->SW_state==pressed)
 156   2      		{
 157   3      			TIMER_INTERVAL_DELAY+=60;
 158   3      			if(TIMER_INTERVAL_DELAY>=900)
 159   3      			{
 160   4      				TIMER_INTERVAL_DELAY=900;
 161   4      			}
 162   3      		}
 163   2      		else if(SW3_p->SW_state==pressed)
 164   2      		{
 165   3      			TIMER_INTERVAL_DELAY-=60;
 166   3      			if(TIMER_INTERVAL_DELAY<60)
 167   3      			{
 168   4      				TIMER_INTERVAL_DELAY=60;
 169   4      			}
 170   3      		}
 171   2      		else if(SW1_p==pressed||SW4_p==pressed)
 172   2      		{
 173   3      			SYSTEM_STATE = IDLE_STATE;
 174   3      		}
 175   2      	}
 176   1      }
 177          
 178          

C51 COMPILER V6.02  BLINKING_LIGHTS                                                        12/04/2019 07:49:34 PAGE 4   


MODULE INFORMATION:   STATIC OVERLAYABLE
   CODE SIZE        =   1040    ----
   CONSTANT SIZE    =   ----    ----
   XDATA SIZE       =   ----    ----
   PDATA SIZE       =   ----    ----
   DATA SIZE        =     21    ----
   IDATA SIZE       =   ----    ----
   BIT SIZE         =      2    ----
END OF MODULE INFORMATION.


C51 COMPILATION COMPLETE.  0 WARNING(S),  0 ERROR(S)
