C51 COMPILER V6.02  BLINKING_LIGHTS                                                        12/04/2019 02:39:19 PAGE 1   


C51 COMPILER V6.02, COMPILATION OF MODULE BLINKING_LIGHTS
OBJECT MODULE PLACED IN .\Blinking_Lights.OBJ
COMPILER INVOKED BY: C:\Keil\C51\BIN\C51.EXE .\Blinking_Lights.c DEBUG OBJECTEXTEND

stmt level    source

   1          #include "Blinking_Lights.h"
   2          #include "Buttons.h"
   3          #include "Port.h"
   4          #include <stdio.h>
   5          
   6          volatile states_t SYSTEM_STATE = IDLE_STATE;
   7          //overall_state TOTAL_STATE = NO_MODE;
   8          
   9          volatile uint32_t TIMER_INTERVAL_DELAY = 660;
  10          
  11          uint8_t strobe_lights = 0;
  12          uint32_t TIMER = 0;
  13          
  14          void set_lights(uint8_t light_config) {
  15   1      	light_config = light_config << 4;
  16   1      	P2 = light_config|0x0F;
  17   1      }
  18          
  19          SW_values_t * SW1_p, *SW2_p, *SW3_p, *SW4_p;
  20          
  21          void blinking_lights_isr(void) interrupt TIMER_2_OVERFLOW {
  22   1      	
  23   1      	TF2=0;
  24   1      	SW1_p = Return_SW1_address();
  25   1      	SW2_p = Return_SW2_address();
  26   1      	SW3_p = Return_SW3_address();
  27   1      	SW4_p = Return_SW4_address();
  28   1          TIMER++; // increment timer
  29   1      
  30   1      	Read_Switch(SW1_p);
  31   1      	Read_Switch(SW2_p);
  32   1      	Read_Switch(SW3_p);
  33   1      	Read_Switch(SW4_p);
  34   1      	
  35   1      	if(TIMER==TIMER_INTERVAL_DELAY)
  36   1      	{
  37   2      		LED_State_Change();
  38   2      		TIMER=0;
  39   2      	}
  40   1      }
  41          
  42          void LED_State_Change(void)
  43          {
  44   1      	if(SYSTEM_STATE == IDLE_STATE)
  45   1      	{
  46   2      		set_lights(15);
  47   2      		if(SW2_p->SW_state==pressed||SW3_p->SW_state==pressed)
  48   2      		{
  49   3      			SYSTEM_STATE=TIMER_INCREMENT_MODE;
  50   3      		}
  51   2      		/*
  52   2      		else if(SW1_p->SW_state==pressed)
  53   2      		{
  54   2      			SYSTEM_STATE = STATE_1;
  55   2      			set_lights(0x7F);
C51 COMPILER V6.02  BLINKING_LIGHTS                                                        12/04/2019 02:39:19 PAGE 2   

  56   2      			TIMER = 0;
  57   2      		}	*/		
  58   2      	}
  59   1      	/*
  60   1      	else if(SYSTEM_STATE==STATE_1)
  61   1      	{
  62   1      
  63   1      		SYSTEM_STATE = STATE_2;
  64   1      		set_lights(0x3F);
  65   1      		TIMER = 0;
  66   1      	}
  67   1      	else if(SYSTEM_STATE==STATE_2)
  68   1      	{
  69   1      		SYSTEM_STATE = STATE_3;
  70   1      		set_lights(0x1F);
  71   1      		TIMER = 0;
  72   1      	}
  73   1      	else if(SYSTEM_STATE==STATE_3)
  74   1      	{
  75   1      		SYSTEM_STATE = STATE_4;
  76   1      		set_lights(0x0F);
  77   1      		TIMER = 0;
  78   1      	}
  79   1      	else if(SYSTEM_STATE==STATE_4)
  80   1      	{
  81   1      
  82   1      		SYSTEM_STATE = STATE_5;
  83   1      		set_lights(0x8F);
  84   1      		TIMER = 0;
  85   1      	}
  86   1      	else if(SYSTEM_STATE==STATE_5)
  87   1      	{
  88   1      		SYSTEM_STATE = STATE_6;
  89   1      		set_lights(0xCF);
  90   1      		TIMER = 0;
  91   1      	}
  92   1      	else if(SYSTEM_STATE==STATE_6)
  93   1      	{
  94   1      
  95   1      		SYSTEM_STATE = STATE_7;
  96   1      		set_lights(0xEF);
  97   1      		TIMER = 0;
  98   1      
  99   1      	}
 100   1      	else if(SYSTEM_STATE==STATE_7)
 101   1      	{
 102   1      		SYSTEM_STATE = IDLE_STATE;
 103   1      		set_lights(0xFF);
 104   1      		TIMER = 0;
 105   1      	}
 106   1      	*/
 107   1      	else if(SYSTEM_STATE==TIMER_INCREMENT_MODE)
 108   1      	{
 109   2      	    if(SW2_p->SW_state==pressed)
 110   2      		{
 111   3      			//set_lights(0x00);
 112   3      			TIMER_INTERVAL_DELAY+=60;
 113   3      			if(TIMER_INTERVAL_DELAY>=900)
 114   3      			{
 115   4      				TIMER_INTERVAL_DELAY=900;
 116   4      			}
 117   3      			set_lights(~((uint8_t) TIMER_INTERVAL_DELAY/60));
C51 COMPILER V6.02  BLINKING_LIGHTS                                                        12/04/2019 02:39:19 PAGE 3   

 118   3      		}
 119   2      		else if(SW3_p->SW_state==pressed)
 120   2      		{
 121   3      			//set_lights(0x00);
 122   3      			TIMER_INTERVAL_DELAY-=60;
 123   3      			if(TIMER_INTERVAL_DELAY<60)
 124   3      			{
 125   4      				TIMER_INTERVAL_DELAY=60;
 126   4      			}
 127   3      			set_lights(~((uint8_t) TIMER_INTERVAL_DELAY/60));
 128   3      		}
 129   2      		else if(SW1_p==pressed||SW4_p==pressed)
 130   2      		{
 131   3      			SYSTEM_STATE = IDLE_STATE;
 132   3      		}
 133   2      	}
 134   1      }
 135          


MODULE INFORMATION:   STATIC OVERLAYABLE
   CODE SIZE        =    428    ----
   CONSTANT SIZE    =   ----    ----
   XDATA SIZE       =   ----    ----
   PDATA SIZE       =   ----    ----
   DATA SIZE        =     22    ----
   IDATA SIZE       =   ----    ----
   BIT SIZE         =   ----    ----
END OF MODULE INFORMATION.


C51 COMPILATION COMPLETE.  0 WARNING(S),  0 ERROR(S)
